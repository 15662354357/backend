# 后端启动问题排查

## 问题描述

启动时出现错误：
```
java.lang.IllegalArgumentException: Invalid value type for attribute 'factoryBeanObjectType': java.lang.String
```

## 问题原因

这是 Spring Boot 3.2.0 与 MyBatis Plus 3.5.7 之间的兼容性问题。Spring Boot 3.2.0 在某些 Bean 工厂处理上有变化，导致 MyBatis Plus 的 FactoryBean 注册出现问题。

## 解决方案

### 方案一：降级 Spring Boot（已采用）

已将 Spring Boot 从 3.2.0 降级到 3.1.5，该版本与 MyBatis Plus 3.5.7 兼容性更好。

```xml
<parent>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-parent</artifactId>
    <version>3.1.5</version>
    <relativePath/>
</parent>
```

### 方案二：如果仍想使用 Spring Boot 3.2.0

可以尝试升级到最新版本的 MyBatis Plus（3.5.9 或更高），或者等待 MyBatis Plus 发布新版本。

## 修复步骤

1. **清理项目**
   ```bash
   mvn clean
   ```

2. **删除本地仓库缓存（可选）**
   ```bash
   rm -rf ~/.m2/repository/org/springframework/boot
   ```

3. **重新下载依赖**
   ```bash
   mvn dependency:resolve
   ```

4. **重新编译**
   ```bash
   mvn compile
   ```

5. **启动应用**
   ```bash
   mvn spring-boot:run
   ```

## 已做的修改

1. ✅ 降级 Spring Boot：3.2.0 → 3.1.5
2. ✅ 升级 MyBatis Plus：3.5.5 → 3.5.7
3. ✅ 分离 MetaObjectHandler 为独立的 Component
4. ✅ 添加 @MapperScan 注解

## 版本兼容性参考

| Spring Boot | MyBatis Plus | Java | 状态 |
|------------|--------------|------|------|
| 3.1.5      | 3.5.7       | 17+  | ✅ 兼容 |
| 3.2.0      | 3.5.7       | 17+  | ⚠️ 部分兼容性问题 |
| 3.2.0      | 3.5.9+      | 17+  | ✅ 兼容（新版本） |

## 如果问题仍然存在

1. **检查依赖冲突**
   ```bash
   mvn dependency:tree
   ```

2. **检查是否有重复的依赖**
   ```bash
   mvn dependency:analyze
   ```

3. **查看详细错误信息**
   在 `application.yml` 中添加：
   ```yaml
   logging:
     level:
       org.springframework: DEBUG
   ```

4. **尝试排除可能有问题的依赖**
   检查是否有其他依赖与 MyBatis Plus 冲突

## 相关链接

- [MyBatis Plus 官方文档](https://baomidou.com/)
- [Spring Boot 官方文档](https://spring.io/projects/spring-boot)
- [GitHub Issues](https://github.com/baomidou/mybatis-plus/issues)

